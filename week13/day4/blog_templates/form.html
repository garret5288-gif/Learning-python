{% extends 'base.html' %}
{% block title %}{{ 'New Post' if mode == 'create' else 'Edit Post' }}{% endblock %}
{% block content %}
<h2 class="h4 mb-3">{{ 'New Post' if mode == 'create' else 'Edit Post' }}</h2>
<form method="post" class="mb-3">
    <div class="mb-3">
        <label for="title" class="form-label">Title</label>
        <input type="text" class="form-control" id="title" name="title" value="{{ (post.title if post else '') | e }}"
            required>
    </div>

    {% if session.get('username') %}
    <p class="text-muted small">Author: {{ session.get('username') }} (logged in)</p>
    {% else %}
    <div class="mb-3">
        <label for="author" class="form-label">Author</label>
        <input type="text" class="form-control" id="author" name="author"
            value="{{ (post.author if post else '') | e }}" placeholder="Anonymous">
    </div>
    {% endif %}

    <div class="mb-3">
        <label for="content" class="form-label">Content</label>
        <textarea class="form-control" id="content" name="content"
            required>{{ (post.content if post else '') | e }}</textarea>
    </div>

    <div class="d-flex gap-2">
        <button class="btn btn-primary" type="submit">{{ 'Create' if mode == 'create' else 'Save Changes' }}</button>
        <a class="btn btn-outline-secondary" href="{{ url_for('index') }}">Cancel</a>
    </div>
</form>
{% endblock %}